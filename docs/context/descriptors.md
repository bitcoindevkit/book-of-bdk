# Descriptors Breakdown

!!! note "What to the two descriptors represent?"
    Let's look a bit closer at the two wallet descriptors.

<p>The two <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md" target="_blank">descriptors</a> in the <a href="/cookbook/starter">Starter Example</a> are Taproot descriptors, where the <code>tr</code> refers to <strong>Taproot</strong>-based addresses. Taproot (introduced with Bitcoin's <a href="https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki" target="_blank">BIP341</a>) improves privacy, efficiency, and flexibility for Bitcoin transactions, and the descriptors you're working with define how to derive keys and addresses from an extended private key (<code>tprv</code>). Here's a detailed explanation:</p><h3>Breakdown of the First Descriptor:</h3>
<code class="!whitespace-pre hljs language-bash"><span class="hljs-built_in">tr</span>(tprv8ZgxMBicQKsPdrjwWCyXqqJ4YqcyG4DmKtjjsRt29v1PtD3r3PuFJAjWytzcvSTKnZAGAkPSmnrdnuHWxCAwy3i1iPhrtKAfXRH7dVCNGp6/86<span class="hljs-string">'/1'</span>/0<span class="hljs-string">'/0/*)#g9xn7wf9
</span></code>
<ol><li><p><strong><code>tr</code></strong>: This indicates that the descriptor is for a <strong>Taproot</strong> (<a href="https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki" target="_blank">BIP341</a>) address.</p></li><li><p><strong><code>tprv8ZgxMBicQKsPdrjwWCyXqqJ4YqcyG4DmKtjjsRt29v1PtD3r3PuFJAjWytzcvSTKnZAGAkPSmnrdnuHWxCAwy3i1iPhrtKAfXRH7dVCNGp6</code></strong>: This is the <strong>extended private key (tprv)</strong> in testnet format, which is used to derive addresses. The prefix <code>tprv</code> indicates that this is a testnet (or signet) private key (on mainnet, it would be <code>xprv</code>).</p></li><li><p><strong><code>/86'/1'/0'/0/*</code></strong>: This is the <strong>derivation path</strong>. Here's the breakdown:</p><ul><li><strong><code>86'</code></strong>: The first level (<code>86'</code>) refers to the derivation path for <strong><a href="https://github.com/bitcoin/bips/blob/master/bip-0086.mediawiki" target="_blank">BIP86</a></strong>, which is used for Taproot addresses.</li><li><strong><code>1'</code></strong>: This refers to the <strong>coin type</strong> (in this case, <code>1'</code> is for <strong>Bitcoin Testnet</strong>, while <code>0'</code> would represent Bitcoin Mainnet).</li><li><strong><code>0'</code></strong>: This is the <strong>account index</strong>. The first account is <code>0'</code>, which allows multiple accounts within the same wallet.</li><li><strong><code>0</code></strong>: This specifies the <strong>change type</strong>, where <code>0</code> represents <strong>external addresses</strong> (receiving addresses) and <code>1</code> would represent <strong>internal addresses</strong> (change addresses).</li><li><strong><code>*</code></strong>: The asterisk (<code>*</code>) is a wildcard, which means the descriptor can derive multiple addresses by incrementing the final index. Each new address generated would have a different index value.</li></ul></li><li><p><strong><code>#g9xn7wf9</code></strong>: This is a <strong>checksum</strong> used to verify the integrity of the descriptor and ensure that it hasn't been tampered with.</p></li></ol><h3>Breakdown of the Second Descriptor:</h3><code class="!whitespace-pre hljs language-bash"><span class="hljs-built_in">tr</span>(tprv8ZgxMBicQKsPdrjwWCyXqqJ4YqcyG4DmKtjjsRt29v1PtD3r3PuFJAjWytzcvSTKnZAGAkPSmnrdnuHWxCAwy3i1iPhrtKAfXRH7dVCNGp6/86<span class="hljs-string">'/1'</span>/0<span class="hljs-string">'/1/*)#e3rjrmea
</span></code><p>This second descriptor is nearly identical to the first, but there's one important difference in the derivation path: the change type.</p><ul><li><strong>Change type</strong>: In the second descriptor, the <strong>change type</strong> is <code>1</code>:<br/><code class="!whitespace-pre hljs language-bash">/86<span class="hljs-string">'/1'</span>/0<span class="hljs-string">'/1/*
</span></code><ul><li><strong><code>1</code></strong> represents <strong>internal (change) addresses</strong>, which are used by the wallet to store change from a transaction (i.e., unused funds that get returned to the wallet after a spend).</li></ul></li></ul><p>In contrast, the first descriptor uses <strong><code>0</code></strong> for the change type:</p><code class="!whitespace-pre hljs language-bash">/86<span class="hljs-string">'/1'</span>/0<span class="hljs-string">'/0/*
</span></code><ul><li><strong><code>0</code></strong> represents <strong>external (receiving) addresses</strong>, which are used to receive funds from others.</li></ul><h3>Key Difference:</h3><ul><li>The <strong>first descriptor</strong> generates <strong>external addresses</strong> (<code>/0/*</code>), which are addresses you share publicly to receive Bitcoin.</li><li>The <strong>second descriptor</strong> generates <strong>internal (change) addresses</strong> (<code>/1/*</code>), which are used by the wallet to receive change after sending Bitcoin.</li></ul><p>Both descriptors derive addresses from the same extended private key but use different branches for receiving funds and handling change, which is typical in hierarchical deterministic wallets (HD wallets) like those based on BIP44, BIP49, or BIP86.</p>

!!! note "Why two descriptors?"
    Let's look closer at why the wallet uses two descriptors and when it uses each.

<p>When creating a Bitcoin wallet using the two descriptors, you are defining <strong>two distinct address types</strong>: external addresses and internal (change) addresses. Both types are essential for the proper functioning of a hierarchical deterministic (HD) wallet.</p><h3>Why You Use Both Descriptors in a Wallet:</h3><ul><li><p><strong>External Descriptor (first descriptor)</strong>: This descriptor is used to generate <strong>external addresses</strong> where you will receive funds from other users. These are the addresses you share publicly, either by generating QR codes, giving the address to someone, or using it in invoices for payments. External addresses are meant for receiving Bitcoin from the outside world.</p></li><li><p><strong>Internal (Change) Descriptor (second descriptor)</strong>: This descriptor is used to generate <strong>internal (change) addresses</strong>, which are addresses your wallet uses internally to receive the "change" from your own transactions. When you send Bitcoin, often you don't spend the exact amount in a single transaction output, so any leftover (change) is sent back to your wallet using these internal addresses. The change is sent to an address that isn’t publicly shared to help preserve privacy.</p></li></ul><h3>When the Wallet Uses One Descriptor vs. the Other:</h3><ol><li><p><strong>Receiving Bitcoin (External Addresses)</strong>:</p><ul><li>When someone sends Bitcoin to you, the wallet generates an <strong>external address</strong> (using the first descriptor) to receive the funds. These addresses are part of the external chain (<code>/0/*</code>), meaning they are derived from the external part of your HD wallet tree.</li><li>External addresses are what you give out or display publicly. They're used every time you want to receive a new payment, ensuring each payment goes to a unique address, which is important for privacy.</li></ul></li><li><p><strong>Sending Bitcoin (Change Addresses)</strong>:</p><ul><li>When you spend Bitcoin, your wallet often needs to send "change" back to itself. This is because Bitcoin transactions involve spending the entire value of an unspent transaction output (UTXO), and if the amount you want to send is less than the UTXO’s value, the leftover (change) has to go back to you.</li><li>The wallet automatically generates an <strong>internal address</strong> (using the second descriptor, from the internal chain <code>/1/*</code>) to receive the change. This is done internally by the wallet, and you don’t see or need to manage these addresses. They're hidden from the user to avoid confusion but are essential for keeping track of your full balance.</li><li>By using a separate internal chain for change, you avoid mixing up addresses used for receiving payments from others with those used for change, which helps protect privacy.</li></ul></li></ol><h3>Internal vs. External Addresses:</h3><ol><li><p><strong>External Addresses (Defined by the First Descriptor <code>/0/*</code>)</strong>:</p><ul><li><strong>Purpose</strong>: Used for <strong>receiving funds</strong> from other users or services.</li><li><strong>Privacy Consideration</strong>: These addresses are <strong>publicly shared</strong>, so they are linked to your identity or the entity you're interacting with (e.g., when receiving payments from someone else).</li><li><strong>Usage</strong>: Every time you request a payment, your wallet generates a new external address. This helps maintain privacy by using a unique address for each transaction, so the same address isn't reused.</li><li><strong>Example Use Case</strong>: When you create an invoice or ask someone to send you Bitcoin, the wallet generates an external address to be shared.</li></ul></li><li><p><strong>Internal (Change) Addresses (Defined by the Second Descriptor <code>/1/*</code>)</strong>:</p><ul><li><strong>Purpose</strong>: Used for receiving <strong>change</strong> from transactions when you send Bitcoin. You do not share these addresses with others.</li><li><strong>Privacy Consideration</strong>: By using separate change addresses, your wallet avoids publicly exposing the change addresses, making it harder for an outside observer to link your payments together or associate your change with your identity.</li><li><strong>Usage</strong>: When you send Bitcoin and there is leftover change (since you cannot spend part of a UTXO), the wallet automatically sends that change to an internal address.</li><li><strong>Example Use Case</strong>: When you spend 0.5 BTC from a UTXO of 1 BTC, the wallet will send 0.5 BTC to the recipient and the remaining 0.5 BTC as "change" to one of your internal addresses.</li></ul></li></ol><h3>Why Both are Defined in the Same Wallet:</h3><ol><li><p><strong>Efficient Management of Transactions</strong>:</p><ul><li>Bitcoin transactions often involve change, so a wallet needs a separate address space for change addresses. Mixing change with external addresses would make it harder to track how much Bitcoin is for spending and how much is left as change. By using separate chains for internal and external addresses, the wallet maintains better organization.</li></ul></li><li><p><strong>Improved Privacy</strong>:</p><ul><li>Having separate internal (change) addresses improves privacy. If you reuse an external address for change, it becomes obvious to anyone analyzing the blockchain that this address is controlled by the same entity, linking your payments and possibly revealing your balance. By using separate internal addresses for change, you compartmentalize your transaction history, making it harder for observers to link addresses together.</li></ul></li><li><p><strong>Compatibility with Wallet Standards</strong>:</p><ul><li>This approach follows common wallet standards like <strong>BIP44</strong>, <strong>BIP49</strong>, and <strong>BIP84</strong>, which specify separate address spaces for external and internal chains. This ensures your wallet is compatible with other wallets and allows you to recover your funds across different wallet software.</li></ul></li></ol><h3>Practical Example:</h3><ol><li><p><strong>Receiving funds</strong>: You ask someone to send you 0.1 BTC. The wallet generates an external address (from <code>/0/*</code>), and the Bitcoin is sent to that address.</p></li><li><p><strong>Sending funds</strong>: You decide to spend 0.08 BTC, but the wallet only has UTXOs of 0.1 BTC. The wallet sends 0.08 BTC to the recipient and automatically sends 0.02 BTC as change to an internal (change) address (from <code>/1/*</code>).</p></li><li><p><strong>Result</strong>: To someone watching the blockchain, they see 0.08 BTC sent to the recipient but can't easily link the 0.02 BTC change to you, because it's sent to an internal address rather than the same external address you used to receive Bitcoin.</p></li></ol>

!!! note "Is the second descriptor necessary?"
    In this case the second descriptor could be inferred from the first, let's look closer at why it wasn't.

!!! warning "WIP"
    (??? need to doulbe check with bdk team on this. my guess is that this level of explicitness limits the search space for the wallet, so instead of searching all possible addresses to discover the relevant UTXO set, the search space is manually defined in, and very limited by, the descriptors. Although the second descriptor could be inferred from the first in this case, there are usecases where that isn't a safe assumption, so it's good to explicitly define both. ???)